

id = \x -> x

0 = $mint id
1 = $msuc 0
2 = $msuc 1
3 = $msuc 2
4 = $msuc 3

$pbooly $booly

[] = id $mlist

cc = $cons 1 ($cons 2 ($cons 4 ($cons 3 [])))

genlist = \f n0 ->
	$cons (f n0) (genlist f ($msuc n0))

at = \l n ->
	$mif ($mis0 n)
	($head l)
	(at ($tail l) ($mdec n))

fold = \f l acc ->
	$mif ($mnil l)
	acc
	(fold f ($tail l) (f acc ($head l)))

sum = \l -> fold $add l 0

take = \l n ->
	$mif ($mis0 n)
	[]
	($cons ($head l) (take ($tail l) ($mdec n)))


inf1 = genlist id 0

sum4 = sum (take 4 inf1)

$pmint ($head inf1)

$pmint (sum cc)

$pmint ($head cc)

$pmint (at cc 2)
